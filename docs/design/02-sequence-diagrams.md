# 시퀀스 다이어그램
##  🛒 상품 목록 조회
```mermaid
sequenceDiagram
    actor 사용자
    participant 상품 목록 조회 API
    participant 상품
    participant 브랜드

    사용자->>+상품 목록 조회 API: 상품 목록 조회 요청 (브랜드?, 정렬 기준?, 페이지 번호?, 페이지당 상품 수?)
    Note right of 상품 목록 조회 API: 누락된 파라미터는 기본값으로 설정

    상품 목록 조회 API->>+상품: 상품 목록 조회 요청 (적용된 파라미터 포함)

    상품->>+브랜드: 브랜드 존재 여부 확인
    alt 브랜드가 존재하지 않을 경우
        브랜드-->>상품: 브랜드 존재하지 않음
        상품-->>상품 목록 조회 API: 오류 반환
        상품 목록 조회 API-->>사용자: "상품 목록을 조회할 수 없습니다."
    else 브랜드가 존재하거나 빈 값인 경우
        브랜드-->>-상품: 브랜드 존재하거나 빈 값
        상품-->>-상품 목록 조회 API: 상품 목록 응답
        상품 목록 조회 API-->>-사용자: 상품 목록(좋아요 수 포함) 응답
    end
```

## 🎁 상품 상세 조회
```mermaid
sequenceDiagram
    actor 사용자
    participant 상품 상세 조회 API
    participant 상품

    사용자->>+상품 상세 조회 API: 상품 상세 조회 요청 (상품 ID)
    상품 상세 조회 API->>+상품: 상품 ID로 상품 상세 정보 조회

    alt 상품이 존재하지 않을 경우
        상품-->>상품 상세 조회 API: 오류 반환
        상품 상세 조회 API-->>사용자: "상품 상세 정보를 조회할 수 없습니다."
    else 상품이 존재할 경우
        상품-->>-상품 상세 조회 API: 상품 상세 정보 응답
        상품 상세 조회 API-->>-사용자: 상품 상세 정보(좋아요 수 포함) 응답
    end
```

## 🏷️ 브랜드 조회
```mermaid
sequenceDiagram
    actor 사용자
    participant 브랜드 조회 API
    participant 브랜드

    사용자->>+브랜드 조회 API: 브랜드 조회 요청 (브랜드 ID)
    브랜드 조회 API->>+브랜드: 브랜드 ID로 브랜드 정보 조회

    alt 브랜드가 존재하지 않을 경우
        브랜드-->>브랜드 조회 API: 오류 반환
        브랜드 조회 API-->>사용자: "브랜드 정보를 조회할 수 없습니다."
    else 브랜드가 존재할 경우
        브랜드-->>-브랜드 조회 API: 브랜드 상세 정보 응답
        브랜드 조회 API-->>-사용자: 브랜드 상세 정보 응답
    end
```

## 🫶 상품 좋아요 등록
- 사용자는 로그인 완료된 상태라고 가정한다.
- 사용자는 **각 상품에 한 번만 좋아요** 를 누를 수 있으며 좋아요 등록 기능은 멱등하게 동작한다.
```mermaid
sequenceDiagram
actor 사용자
participant 상품 좋아요 등록 API
participant 좋아요
participant 회원
participant 상품

    사용자->>+상품 좋아요 등록 API: 좋아요 요청 (상품 ID)

    상품 좋아요 등록 API->>+좋아요: 좋아요 등록 요청 (상품 ID, 사용자 ID)
    좋아요->>+회원: 사용자 존재 여부 확인

    alt 사용자가 존재하지 않을 경우
        회원-->>좋아요: 사용자 없음
        좋아요-->>상품 좋아요 등록 API: 오류 반환
        상품 좋아요 등록 API-->>사용자: "사용자가 존재하지 않습니다."
    else 사용자가 존재할 경우
        회원-->>-좋아요: 사용자 있음
        좋아요->>+상품: 상품 존재 여부 확인
        alt 상품이 존재하지 않을 경우
            상품-->>좋아요: 상품 없음
            좋아요-->>상품 좋아요 등록 API: 오류 반환
            상품 좋아요 등록 API-->>사용자: "해당 상품이 존재하지 않습니다."
        else 상품이 존재할 경우
            상품-->>-좋아요: 상품 있음
            좋아요->>좋아요: 좋아요 등록
            좋아요-->>-상품 좋아요 등록 API: 좋아요 등록 응답
            상품 좋아요 등록 API-->>-사용자: 좋아요 등록 완료
        end
    end
```

## 🫶 상품 좋아요 취소
- 사용자는 로그인 완료된 상태라고 가정한다.
- 좋아요 취소 기능은 멱등하게 동작한다.
```mermaid
sequenceDiagram
    actor 사용자
    participant 상품 좋아요 취소 API
    participant 좋아요
    participant 회원
    participant 상품

    사용자->>+상품 좋아요 취소 API: 좋아요 취소 요청 (상품 ID)

    상품 좋아요 취소 API->>+좋아요: 좋아요 취소 요청 (상품 ID, 사용자 ID)
    좋아요->>+회원: 사용자 존재 여부 확인

    alt 사용자가 존재하지 않을 경우
        회원-->>좋아요: 사용자 없음
        좋아요-->>상품 좋아요 취소 API: 오류 반환
        상품 좋아요 취소 API-->>사용자: "사용자가 존재하지 않습니다."
    else 사용자가 존재할 경우
        회원-->>-좋아요: 사용자 있음
        좋아요->>+상품: 상품 존재 여부 확인
        alt 상품이 존재하지 않을 경우
            상품-->>좋아요: 상품 없음
            좋아요-->>상품 좋아요 취소 API: 오류 반환
            상품 좋아요 취소 API-->>사용자: "해당 상품이 존재하지 않습니다."
        else 상품이 존재할 경우
            상품-->>-좋아요: 상품 있음
            좋아요->>좋아요: 좋아요 취소
            좋아요-->>-상품 좋아요 취소 API: 좋아요 취소 응답
            상품 좋아요 취소 API-->>-사용자: 좋아요 취소 완료
        end
    end
```

## 😍 사용자가 좋아요 한 상품 목록 조회
- 사용자는 로그인 완료된 상태라고 가정한다.
```mermaid
sequenceDiagram
actor 사용자
participant 좋아요 목록 조회 API
participant 좋아요
participant 회원

    사용자->>+좋아요 목록 조회 API: 좋아요 상품 목록 조회 요청 (사용자 ID)

    좋아요 목록 조회 API->>+좋아요: 좋아요 한 상품 목록 조회
    좋아요->>+회원: 사용자 존재 여부 확인

    alt 사용자가 존재하지 않을 경우
        회원-->>좋아요: 사용자 존재하지 않음
        좋아요-->>좋아요 목록 조회 API: 오류 반환
        좋아요 목록 조회 API-->>사용자: "사용자가 존재하지 않습니다."
    else 사용자 존재할 경우
        회원-->>-좋아요: 사용자 존재함
        좋아요-->>-좋아요 목록 조회 API: 좋아요 한 상품 목록 응답
        좋아요 목록 조회 API-->>-사용자: 좋아요 한 상품 목록 응답
    end
```

## 💳 주문 생성 및 결제
- 사용자는 로그인 완료된 상태라고 가정한다.
- 주문 시 필요한 처리:
  - 상품 재고 확인 및 차감
  - 포인트 확인 및 차감
  - 주문 정보 외부 시스템 전송 **(Mock 처리 가능)**
```mermaid
sequenceDiagram
    actor 사용자
    participant 주문 생성 API
    participant 주문
    participant 회원
    participant 상품
    participant 포인트
    participant 재고
    participant 외부 시스템

    사용자->>+주문 생성 API: 주문 요청 (상품 ID + 수량 리스트)

    주문 생성 API->>+주문: 주문 생성 요청 (상품 목록, 사용자 ID)
    주문->>+회원: 사용자 존재 여부 확인

    alt 사용자가 존재하지 않을 경우
        회원-->>주문: 사용자 존재하지 않음
        주문-->>주문 생성 API: 오류 반환
        주문 생성 API-->>사용자: "사용자가 존재하지 않습니다."
    else 사용자 존재할 경우
        회원-->>-주문: 사용자 존재함
        주문->>+재고: 각 상품 재고 차감
        alt 재고가 부족할 경우
            재고-->>주문: 재고가 부족함
            주문-->>주문 생성 API: 오류 반환
            주문 생성 API-->>사용자: "상품 재고가 부족합니다."
        else 재고가 충분한 경우
            재고-->>-주문: 재고 차감 성공
            주문->>+포인트: 사용자 포인트 차감
            alt 포인트가 부족할 경우
                포인트-->>주문: 포인트가 부족함
                주문-->>주문 생성 API: 오류 반환
                주문 생성 API-->>사용자: "포인트가 부족합니다."
            else 포인트가 충분할 경우
                포인트-->>-주문: 포인트 차감 성공
                주문->>+외부 시스템: 주문 정보 전송
                alt 외부 시스템 연동 실패
                    외부 시스템-->>주문: 연동 실패
                    주문-->>주문 생성 API: 오류 반환
                    주문 생성 API-->>사용자: "주문이 완료되지 못했습니다."
                else 외부 시스템 연동 성공
                    외부 시스템-->>-주문: 주문 전송 완료
                    주문-->>-주문 생성 API: 주문 ID 반환
                    주문 생성 API-->>-사용자: 주문 완료 (주문 ID)
                end
            end
        end
    end
```

## 🗂️ 사용자의 주문 목록 조회
- 사용자는 로그인 완료된 상태라고 가정한다.
```mermaid
sequenceDiagram
actor 사용자
participant 주문 목록 조회 API
participant 주문
participant 회원

    사용자->>+주문 목록 조회 API: 주문 목록 조회 요청 (사용자 ID)

    주문 목록 조회 API->>+주문: 주문 목록 조회
    주문->>+회원: 사용자 존재 여부 확인

    alt 사용자가 존재하지 않을 경우
        회원-->>주문: 사용자 존재하지 않음
        주문-->>주문 목록 조회 API: 오류 반환
        주문 목록 조회 API-->>사용자: "사용자가 존재하지 않습니다."
    else 사용자 존재할 경우
        회원-->>-주문: 사용자 존재함
        주문-->>-주문 목록 조회 API: 주문 목록 응답
        주문 목록 조회 API-->>-사용자: 주문 목록 응답
    end
```

## 📌 단일 주문 상세 조회
- 사용자는 로그인 완료된 상태라고 가정한다.
```mermaid
sequenceDiagram
actor 사용자
participant 단일 주문 상세 조회 API
participant 주문
participant 회원

    사용자->>+단일 주문 상세 조회 API: 주문 상세 조회 요청 (주문 ID)

    단일 주문 상세 조회 API->>+주문: 단일 주문 상세 조회
    주문->>+회원: 사용자 존재 여부 확인

    alt 사용자가 존재하지 않을 경우
        회원-->>주문: 사용자 존재하지 않음
        주문-->>단일 주문 상세 조회 API: 오류 반환
        단일 주문 상세 조회 API-->>사용자: "사용자가 존재하지 않습니다."
    else 사용자 존재할 경우
        회원-->>-주문: 사용자 존재함
        alt 주문이 존재하지 않을 경우
            주문-->>단일 주문 상세 조회 API: 오류 반환
            단일 주문 상세 조회 API-->>사용자: "해당 주문이 존재하지 않습니다."
        else 주문이 존재할 경우
            주문-->>-단일 주문 상세 조회 API: 주문 상세 정보 응답
            단일 주문 상세 조회 API-->>-사용자: 주문 상세 정보 응답
        end
    end
```